section.market(scroll ng-controller="marketController")
  header.market-header(ng-class="{fixed:boolChangeClass}")
    ul.market-tabs
      li(class="market-tabs-item" ng-repeat="marketTab in marketTabs")
        a(class="market-tabs-link" href="#" ng-class="{active: isActiveTab(marketTab.url)}" ng-click="onClickTab(marketTab)")
          .tab-icon
            div(ng-include="marketTab.icon")

          | {{ marketTab.title }}

    .market-points(ng-show="boolChangeClass")
      include ./../icons/dollar-icon.pug
      span {{ balance | number }} pts

    canvas(class="countdown" width="200" height="200" countdown)
    span.countdown-timer {{ nextUpdateLabel }}

  .market-content
    include ./../components/loading.pug

    div(ng-include="currentTab")

    audio(class="market-audio" controls id="audio")
      source(src="../assets/coin.mp3" type="audio/mpeg")

    audio(class="market-audio" controls id="audio2")
      source(src="../assets/coin2.mp3" type="audio/mpeg")


script(type="text/ng-template" id="shares")
  .row
    .col-md-4(ng-repeat="share in stocks | orderBy: '-price' track by $index")
      article.market-item
        header.market-item-header
          h2.market-item-header__title {{ share.name}}

        section.market-item-body
          chartist(class="ct-chart ct-golden-section" chartist-data="share.chartData" chartist-chart-type="Line" chartist-chart-options="chartOptions" chartist-responsive-options="barResponsiveOptions" ng-if="responseReceived")

        footer.market-item-footer
          ul.market-item-controls
            li.market-item-spaces
              span.market-item-spaces__title Amount
              input(class="market-item-spaces__input" type="number" ng-model="shareAmount" ng-init="shareAmount = 1")

            li.market-item-spaces
              span.market-item-spaces__title Price
              label.market-item-spaces__info {{ share.price | number }}

            li.market-item-spaces
              span.market-item-spaces__title Total
              label.market-item-spaces__info {{ share.price * shareAmount | number }}

          button.btn.btn-success.btn-block(ng-click="buyShare(share.name, shareAmount)" ng-disabled="stockBtn") Buy for {{ share.price * shareAmount | number }}

script(type="text/ng-template" id="portfolio")
  .row
    .empty-state(ng-hide="portfolio.length > 0")
      include ./../icons/empty-state-portfolio.pug

      h2 You don't have any shares yet
      a(href="/" class="btn btn-success") Buy shares

    .col-md-6(ng-repeat="trade in portfolio" ng-hide="portfolio.length === 0")
      article.market-item
        header.market-item-header
          h2.market-item-header__title {{ trade.stock }}

        section.market-item-body
          chartist(class="ct-chart ct-golden-section" chartist-data="trade.chartData" chartist-chart-type="Line" chartist-chart-options="chartOptions" chartist-responsive-options="barResponsiveOptions" ng-if="responseReceived")

        footer.market-item-footer
          ul.market-item-controls
            li.market-item-spaces.market-item-spaces--portfolio
              span.market-item-spaces__title Amount
              label.market-item-spaces__info {{ trade.amount | number }}

            li.market-item-spaces.market-item-spaces--portfolio
              span.market-item-spaces__title Purchase Price
              label.market-item-spaces__info {{ trade.purchasePrice | number }}

            li.market-item-spaces.market-item-spaces--portfolio
              span.market-item-spaces__title Current Price
              label.market-item-spaces__info {{ trade.currentPrice | number }}

            li.market-item-spaces.market-item-spaces--portfolio
              span.market-item-spaces__title Total
              label.market-item-spaces__info {{ trade.currentPrice * trade.amount | number }}

          button.btn.btn-success.btn-block(ng-click="sellShare(trade)" ng-disabled="stockBtn") Sell for {{ trade.currentPrice * trade.amount | number }}
